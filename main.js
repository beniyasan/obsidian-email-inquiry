/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/
"use strict";var $=Object.create;var y=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var I=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),M=(o,e)=>{for(var t in e)y(o,t,{get:e[t],enumerable:!0})},F=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of N(e))!K.call(o,a)&&a!==t&&y(o,a,{get:()=>e[a],enumerable:!(i=P(e,a))||i.enumerable});return o};var D=(o,e,t)=>(t=o!=null?$(j(o)):{},F(e||!o||!o.__esModule?y(t,"default",{value:o,enumerable:!0}):t,o)),L=o=>F(y({},"__esModule",{value:!0}),o);var k=I((re,O)=>{O.exports={commands:{capture_email:"Capture Email",generate_daily_summary:"Generate Daily Summary",search_knowledge_base:"Search Knowledge Base",bulk_import_emails:"Bulk Import Emails"},ribbon:{capture_email:"Capture Email"},modal:{capture_email:{title:"Capture Email Inquiry",sender_email:"Sender Email",sender_name:"Sender Name",subject:"Subject",category:"Category",priority:"Priority",tags:"Tags",email_content:"Email Content",capture_button:"Capture Email",cancel_button:"Cancel",placeholder:{sender_email:"customer@example.com",sender_name:"John Customer (optional)",subject:"Login Issue - Cannot Access Dashboard",tags:"login-issue, dashboard, urgent",email_content:"Paste email content here..."},validation:{sender_email_required:"Sender email is required",sender_email_invalid:"Please enter a valid email address",subject_required:"Subject is required",content_required:"Email content is required"}}},categories:{specification:"Specification",issue:"Issue",migration_vup:"Migration/VUP",other:"Other"},priorities:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},settings:{title:"Email Inquiry Management",folders:{title:"Folder Settings",emails_folder:"Emails Folder",summaries_folder:"Summaries Folder",knowledge_folder:"Knowledge Folder",emails_folder_desc:"Folder where captured emails will be stored",summaries_folder_desc:"Folder where daily summaries will be saved",knowledge_folder_desc:"Folder where extracted knowledge will be stored"},categories:{title:"Custom Categories",add_category:"Add Custom Category",add_category_desc:"Create a new category for email classification",add_button:"Add",category_placeholder:"Enter category name...",no_custom_categories:"No custom categories defined. Add categories to extend the default options.",manage_desc:"Click the \xD7 button to delete a category. This will not affect existing emails.",delete_confirm:"Are you sure you want to delete the category '{{category}}'? This action cannot be undone.",delete_tooltip:"Delete this category"},defaults:{title:"Default Values",category:"Default Category",priority:"Default Priority",category_desc:"Default category for new emails",priority_desc:"Default priority for new emails"},automation:{title:"Automation Settings",auto_summary:"Auto-generate Daily Summaries",auto_knowledge:"Auto-extract Knowledge",enable_notifications:"Enable Notifications",auto_summary_desc:"Automatically generate daily summaries",auto_knowledge_desc:"Automatically extract knowledge from resolved emails",enable_notifications_desc:"Show notifications for plugin actions"},advanced:{title:"Advanced Settings",max_attachment_size:"Max Attachment Size (MB)",language:"Language",max_attachment_size_desc:"Maximum file size for attachments",language_desc:"Plugin interface language"}},notices:{email_captured:"Email captured: {{path}}",generating_summary:"Generating daily summary for {{date}}...",summary_generated:"Daily summary generated successfully",error_generating_summary:"Error generating summary: {{error}}",knowledge_search_coming_soon:"Knowledge search coming soon...",bulk_import_coming_soon:"Bulk import coming soon...",settings_saved:"Settings saved successfully"},languages:{en:"English",ja:"\u65E5\u672C\u8A9E"}}});var T=I((se,R)=>{R.exports={commands:{capture_email:"\u30E1\u30FC\u30EB\u3092\u30AD\u30E3\u30D7\u30C1\u30E3",generate_daily_summary:"\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u3092\u751F\u6210",search_knowledge_base:"\u77E5\u8B58\u30D9\u30FC\u30B9\u3092\u691C\u7D22",bulk_import_emails:"\u30E1\u30FC\u30EB\u306E\u4E00\u62EC\u30A4\u30F3\u30DD\u30FC\u30C8"},ribbon:{capture_email:"\u30E1\u30FC\u30EB\u3092\u30AD\u30E3\u30D7\u30C1\u30E3"},modal:{capture_email:{title:"\u30E1\u30FC\u30EB\u554F\u3044\u5408\u308F\u305B\u3092\u30AD\u30E3\u30D7\u30C1\u30E3",sender_email:"\u9001\u4FE1\u8005\u30E1\u30FC\u30EB",sender_name:"\u9001\u4FE1\u8005\u540D",subject:"\u4EF6\u540D",category:"\u30AB\u30C6\u30B4\u30EA",priority:"\u512A\u5148\u5EA6",tags:"\u30BF\u30B0",email_content:"\u30E1\u30FC\u30EB\u5185\u5BB9",capture_button:"\u30E1\u30FC\u30EB\u3092\u30AD\u30E3\u30D7\u30C1\u30E3",cancel_button:"\u30AD\u30E3\u30F3\u30BB\u30EB",placeholder:{sender_email:"customer@example.com",sender_name:"\u7530\u4E2D\u592A\u90CE\uFF08\u4EFB\u610F\uFF09",subject:"\u30ED\u30B0\u30A4\u30F3\u554F\u984C - \u30C0\u30C3\u30B7\u30E5\u30DC\u30FC\u30C9\u306B\u30A2\u30AF\u30BB\u30B9\u3067\u304D\u307E\u305B\u3093",tags:"\u30ED\u30B0\u30A4\u30F3\u554F\u984C, \u30C0\u30C3\u30B7\u30E5\u30DC\u30FC\u30C9, \u7DCA\u6025",email_content:"\u30E1\u30FC\u30EB\u5185\u5BB9\u3092\u3053\u3053\u306B\u8CBC\u308A\u4ED8\u3051\u3066\u304F\u3060\u3055\u3044..."},validation:{sender_email_required:"\u9001\u4FE1\u8005\u30E1\u30FC\u30EB\u306F\u5FC5\u9808\u3067\u3059",sender_email_invalid:"\u6709\u52B9\u306A\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",subject_required:"\u4EF6\u540D\u306F\u5FC5\u9808\u3067\u3059",content_required:"\u30E1\u30FC\u30EB\u5185\u5BB9\u306F\u5FC5\u9808\u3067\u3059"}}},categories:{specification:"\u4ED5\u69D8",issue:"\u969C\u5BB3",migration_vup:"\u79FB\u884C/VUP",other:"\u305D\u306E\u4ED6"},priorities:{low:"\u4F4E",medium:"\u4E2D",high:"\u9AD8",urgent:"\u7DCA\u6025"},settings:{title:"\u30E1\u30FC\u30EB\u554F\u3044\u5408\u308F\u305B\u7BA1\u7406",folders:{title:"\u30D5\u30A9\u30EB\u30C0\u8A2D\u5B9A",emails_folder:"\u30E1\u30FC\u30EB\u30D5\u30A9\u30EB\u30C0",summaries_folder:"\u30B5\u30DE\u30EA\u30FC\u30D5\u30A9\u30EB\u30C0",knowledge_folder:"\u30CA\u30EC\u30C3\u30B8\u30D5\u30A9\u30EB\u30C0",emails_folder_desc:"\u30AD\u30E3\u30D7\u30C1\u30E3\u3057\u305F\u30E1\u30FC\u30EB\u3092\u4FDD\u5B58\u3059\u308B\u30D5\u30A9\u30EB\u30C0",summaries_folder_desc:"\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u3092\u4FDD\u5B58\u3059\u308B\u30D5\u30A9\u30EB\u30C0",knowledge_folder_desc:"\u62BD\u51FA\u3057\u305F\u30CA\u30EC\u30C3\u30B8\u3092\u4FDD\u5B58\u3059\u308B\u30D5\u30A9\u30EB\u30C0"},categories:{title:"\u30AB\u30B9\u30BF\u30E0\u30AB\u30C6\u30B4\u30EA",add_category:"\u30AB\u30B9\u30BF\u30E0\u30AB\u30C6\u30B4\u30EA\u3092\u8FFD\u52A0",add_category_desc:"\u30E1\u30FC\u30EB\u5206\u985E\u7528\u306E\u65B0\u3057\u3044\u30AB\u30C6\u30B4\u30EA\u3092\u4F5C\u6210",add_button:"\u8FFD\u52A0",category_placeholder:"\u30AB\u30C6\u30B4\u30EA\u540D\u3092\u5165\u529B...",no_custom_categories:"\u30AB\u30B9\u30BF\u30E0\u30AB\u30C6\u30B4\u30EA\u304C\u5B9A\u7FA9\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u30C7\u30D5\u30A9\u30EB\u30C8\u30AA\u30D7\u30B7\u30E7\u30F3\u3092\u62E1\u5F35\u3059\u308B\u305F\u3081\u306B\u30AB\u30C6\u30B4\u30EA\u3092\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",manage_desc:"\xD7\u30DC\u30BF\u30F3\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u30AB\u30C6\u30B4\u30EA\u3092\u524A\u9664\u3067\u304D\u307E\u3059\u3002\u65E2\u5B58\u306E\u30E1\u30FC\u30EB\u306B\u306F\u5F71\u97FF\u3057\u307E\u305B\u3093\u3002",delete_confirm:"\u30AB\u30C6\u30B4\u30EA '{{category}}' \u3092\u524A\u9664\u3057\u307E\u3059\u304B\uFF1F\u3053\u306E\u64CD\u4F5C\u306F\u5143\u306B\u623B\u305B\u307E\u305B\u3093\u3002",delete_tooltip:"\u3053\u306E\u30AB\u30C6\u30B4\u30EA\u3092\u524A\u9664"},defaults:{title:"\u30C7\u30D5\u30A9\u30EB\u30C8\u5024",category:"\u30C7\u30D5\u30A9\u30EB\u30C8\u30AB\u30C6\u30B4\u30EA",priority:"\u30C7\u30D5\u30A9\u30EB\u30C8\u512A\u5148\u5EA6",category_desc:"\u65B0\u3057\u3044\u30E1\u30FC\u30EB\u306E\u30C7\u30D5\u30A9\u30EB\u30C8\u30AB\u30C6\u30B4\u30EA",priority_desc:"\u65B0\u3057\u3044\u30E1\u30FC\u30EB\u306E\u30C7\u30D5\u30A9\u30EB\u30C8\u512A\u5148\u5EA6"},automation:{title:"\u81EA\u52D5\u5316\u8A2D\u5B9A",auto_summary:"\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u306E\u81EA\u52D5\u751F\u6210",auto_knowledge:"\u30CA\u30EC\u30C3\u30B8\u306E\u81EA\u52D5\u62BD\u51FA",enable_notifications:"\u901A\u77E5\u3092\u6709\u52B9\u5316",auto_summary_desc:"\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u3092\u81EA\u52D5\u7684\u306B\u751F\u6210\u3057\u307E\u3059",auto_knowledge_desc:"\u89E3\u6C7A\u6E08\u307F\u30E1\u30FC\u30EB\u304B\u3089\u30CA\u30EC\u30C3\u30B8\u3092\u81EA\u52D5\u62BD\u51FA\u3057\u307E\u3059",enable_notifications_desc:"\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u52D5\u4F5C\u306B\u5BFE\u3057\u3066\u901A\u77E5\u3092\u8868\u793A\u3057\u307E\u3059"},advanced:{title:"\u8A73\u7D30\u8A2D\u5B9A",max_attachment_size:"\u6700\u5927\u6DFB\u4ED8\u30D5\u30A1\u30A4\u30EB\u30B5\u30A4\u30BA (MB)",language:"\u8A00\u8A9E",max_attachment_size_desc:"\u6DFB\u4ED8\u30D5\u30A1\u30A4\u30EB\u306E\u6700\u5927\u30B5\u30A4\u30BA",language_desc:"\u30D7\u30E9\u30B0\u30A4\u30F3\u30A4\u30F3\u30BF\u30FC\u30D5\u30A7\u30FC\u30B9\u306E\u8A00\u8A9E"}},notices:{email_captured:"\u30E1\u30FC\u30EB\u3092\u30AD\u30E3\u30D7\u30C1\u30E3\u3057\u307E\u3057\u305F: {{path}}",generating_summary:"{{date}}\u306E\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u3092\u751F\u6210\u4E2D...",summary_generated:"\u65E5\u6B21\u30B5\u30DE\u30EA\u30FC\u304C\u6B63\u5E38\u306B\u751F\u6210\u3055\u308C\u307E\u3057\u305F",error_generating_summary:"\u30B5\u30DE\u30EA\u30FC\u751F\u6210\u30A8\u30E9\u30FC: {{error}}",knowledge_search_coming_soon:"\u77E5\u8B58\u691C\u7D22\u6A5F\u80FD\u306F\u8FD1\u65E5\u516C\u958B\u4E88\u5B9A\u3067\u3059...",bulk_import_coming_soon:"\u4E00\u62EC\u30A4\u30F3\u30DD\u30FC\u30C8\u6A5F\u80FD\u306F\u8FD1\u65E5\u516C\u958B\u4E88\u5B9A\u3067\u3059...",settings_saved:"\u8A2D\u5B9A\u304C\u6B63\u5E38\u306B\u4FDD\u5B58\u3055\u308C\u307E\u3057\u305F"},languages:{en:"English",ja:"\u65E5\u672C\u8A9E"}}});var z={};M(z,{default:()=>p});module.exports=L(z);var u=require("obsidian");var f=class o{constructor(e){this.data=e}static create(e){let t=this.generateId(),i=new Date,a={id:t,sender:e.sender,senderName:e.senderName,subject:e.subject,body:e.body,receivedDate:e.receivedDate,status:"pending",tags:e.tags||[],category:e.category,priority:e.priority,attachments:e.attachments,rawContent:e.rawContent,createdAt:i,updatedAt:i};return new o(a)}get id(){return this.data.id}get sender(){return this.data.sender}get senderName(){return this.data.senderName}get subject(){return this.data.subject}get body(){return this.data.body}get receivedDate(){return this.data.receivedDate}get status(){return this.data.status}get tags(){return this.data.tags}get category(){return this.data.category}get priority(){return this.data.priority}get attachments(){return this.data.attachments}get relatedEmails(){return this.data.relatedEmails}get knowledgeEntries(){return this.data.knowledgeEntries}get resolutionNoteId(){return this.data.resolutionNoteId}get rawContent(){return this.data.rawContent}get createdAt(){return this.data.createdAt}get updatedAt(){return this.data.updatedAt}updateStatus(e){this.data.status=e,this.data.updatedAt=new Date}addTag(e){this.data.tags.includes(e)||(this.data.tags.push(e),this.data.updatedAt=new Date)}removeTag(e){let t=this.data.tags.indexOf(e);t>-1&&(this.data.tags.splice(t,1),this.data.updatedAt=new Date)}setCategory(e){this.data.category=e,this.data.updatedAt=new Date}setPriority(e){this.data.priority=e,this.data.updatedAt=new Date}linkToKnowledgeEntry(e){this.data.knowledgeEntries||(this.data.knowledgeEntries=[]),this.data.knowledgeEntries.includes(e)||(this.data.knowledgeEntries.push(e),this.data.updatedAt=new Date)}setResolution(e){this.data.resolutionNoteId=e,this.data.status="resolved",this.data.updatedAt=new Date}linkRelatedEmail(e){this.data.relatedEmails||(this.data.relatedEmails=[]),this.data.relatedEmails.includes(e)||(this.data.relatedEmails.push(e),this.data.updatedAt=new Date)}setThreadId(e){this.data.threadId=e,this.data.updatedAt=new Date}validate(){let e=[];return this.data.id||e.push("ID is required"),this.data.sender||e.push("Sender is required"),this.data.subject||e.push("Subject is required"),this.data.body||e.push("Body is required"),this.data.receivedDate||e.push("Received date is required"),this.data.sender&&!this.isValidEmail(this.data.sender)&&e.push("Sender must be a valid email address"),e}isValid(){return this.validate().length===0}toJSON(){return{...this.data}}toFrontmatter(){return{id:this.data.id,sender:this.data.sender,senderName:this.data.senderName,subject:this.data.subject,receivedDate:this.data.receivedDate.toISOString(),status:this.data.status,tags:this.data.tags,category:this.data.category,threadId:this.data.threadId,priority:this.data.priority,attachments:this.data.attachments,relatedEmails:this.data.relatedEmails,knowledgeEntries:this.data.knowledgeEntries,resolutionNoteId:this.data.resolutionNoteId,createdAt:this.data.createdAt.toISOString(),updatedAt:this.data.updatedAt.toISOString()}}static fromJSON(e){let t={...e,receivedDate:new Date(e.receivedDate),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)};return new o(t)}static generateId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}};var h=class{constructor(e,t="Emails",i,a){this.vault=e,this.emailsFolder=t,this.searchIndexer=i,this.knowledgeExtractionService=a}async captureEmail(e){try{this.validateRequest(e);let t=this.createEmailFromRequest(e),i=await this.generateFilePath(t);e.attachments&&e.attachments.length>0&&await this.processAttachments(e.attachments,t.id);let a=this.generateNoteContent(t);await this.vault.create(i,a),this.searchIndexer&&await this.searchIndexer.addEmail(t);let r=null;if(this.knowledgeExtractionService&&this.knowledgeExtractionService.isEligibleForExtraction(t))try{r=await this.knowledgeExtractionService.extractKnowledgeFromEmail(t),console.log("[EmailCapture] Knowledge extracted:",r)}catch(s){console.error("[EmailCapture] Knowledge extraction failed:",s)}return{id:t.id,path:i,message:r?`Email captured successfully. Knowledge extracted to: ${r}`:"Email captured successfully"}}catch(t){throw new Error(`Failed to capture email: ${t instanceof Error?t.message:String(t)}`)}}validateRequest(e){if(!e.sender)throw new Error("Sender is required");if(!e.subject)throw new Error("Subject is required");if(!e.body)throw new Error("Body is required");if(!e.receivedDate)throw new Error("Received date is required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.sender))throw new Error("Invalid sender email format")}createEmailFromRequest(e){return f.create({sender:e.sender,senderName:e.senderName,subject:e.subject,body:e.body,receivedDate:new Date(e.receivedDate),category:e.category,priority:e.priority||"medium",tags:e.tags||[]})}async generateFilePath(e){let t=e.receivedDate,i=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=`${this.emailsFolder}/${i}/${a}`;await this.vault.exists(s)||await this.vault.createFolder(s);let n=this.sanitizeFilename(e.subject),d=t.toTimeString().substring(0,5).replace(":","-"),m=`${r}-${d}-${n}.md`,x=`${s}/${m}`,C=1;for(;await this.vault.exists(x);)m=`${r}-${d}-${n}-${C}.md`,x=`${s}/${m}`,C++;return x}sanitizeFilename(e){return e.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g,"-").substring(0,50).toLowerCase()}async processAttachments(e,t){let i=`${this.emailsFolder}/Attachments/${t}`;await this.vault.exists(i)||await this.vault.createFolder(i);for(let a of e)if(a.content){let r=Buffer.from(a.content,"base64"),s=`${i}/${a.filename}`;await this.vault.writeFile(s,r)}}generateNoteContent(e){return["---",this.generateFrontmatter(e),"---","",`# ${e.subject}`,"",`**From:** ${e.senderName||e.sender} <${e.sender}>`,`**Date:** ${e.receivedDate.toISOString()}`,`**Status:** ${e.status}`,...e.category?[`**Category:** ${e.category}`]:[],...e.priority?[`**Priority:** ${e.priority}`]:[],...e.tags.length>0?[`**Tags:** ${e.tags.join(", ")}`]:[],"","## Content","",e.body,"","## Notes","","<!-- Add your notes and resolution details here -->",""].join(`
`)}generateFrontmatter(e){let t=e.toFrontmatter(),i=[];for(let[a,r]of Object.entries(t))r!=null&&(Array.isArray(r)?r.length>0&&(i.push(`${a}:`),r.forEach(s=>i.push(`  - ${s}`))):typeof r=="string"?i.push(`${a}: "${r}"`):i.push(`${a}: ${r}`));return i.join(`
`)}};var b=class o{constructor(e){this.data=e}static create(e){let t=new Date,i=crypto.randomUUID();return new o({id:i,title:e.title,problem:e.problem,solution:e.solution,category:e.category,keywords:e.keywords,sourceEmailId:e.sourceEmailId,tags:e.tags,createdAt:t,updatedAt:t})}get id(){return this.data.id}get title(){return this.data.title}get problem(){return this.data.problem}get solution(){return this.data.solution}get category(){return this.data.category}get keywords(){return this.data.keywords}get sourceEmailId(){return this.data.sourceEmailId}get tags(){return this.data.tags}get createdAt(){return this.data.createdAt}toFrontmatter(){return{id:this.data.id,title:this.data.title,category:this.data.category,keywords:this.data.keywords,sourceEmailId:this.data.sourceEmailId,tags:this.data.tags,createdAt:this.data.createdAt.toISOString(),updatedAt:this.data.updatedAt.toISOString()}}},w=class{constructor(e,t){this.vault=e,this.settings=t}async extractKnowledgeFromEmail(e){if(e.status!=="resolved")return console.log(`[KnowledgeExtraction] Skipping knowledge extraction - email not resolved (status: ${e.status})`),null;if(!this.settings.autoExtractKnowledge)return console.log("[KnowledgeExtraction] Auto-extraction is disabled"),null;try{console.log(`[KnowledgeExtraction] Extracting knowledge from email: ${e.id}`);let t=await this.createKnowledgeEntry(e),i=await this.generateKnowledgeFilePath(t),a=this.generateKnowledgeContent(t,e);return await this.vault.create(i,a),console.log(`[KnowledgeExtraction] Knowledge extracted successfully: ${i}`),i}catch(t){throw console.error(`[KnowledgeExtraction] Failed to extract knowledge from email ${e.id}:`,t),new Error(`Failed to extract knowledge: ${t instanceof Error?t.message:String(t)}`)}}isEligibleForExtraction(e){return this.settings.autoExtractKnowledge&&e.status==="resolved"&&e.body.length>50}async createKnowledgeEntry(e){let t=this.extractProblemStatement(e.body),a=this.extractSolution(e.body,""),r=this.extractKeywords(e);return b.create({title:this.generateKnowledgeTitle(e.subject),problem:t,solution:a,category:e.category,keywords:r,sourceEmailId:e.id,tags:[...e.tags,"auto-extracted"]})}extractProblemStatement(e){let i=e.split(/[.!?]+/).map(r=>r.trim()).filter(r=>r.length>0).filter(r=>/\b(how|what|why|when|where|どう|何|なぜ|いつ|どこ|問題|エラー|できない|わからない)/i.test(r)).slice(0,3);if(i.length>0)return i.join(". ")+".";let a=e.split(`

`)[0];return a.length>200?a.substring(0,200)+"...":a}extractSolution(e,t){if(t&&t.trim().length>10)return t;let a=e.split(/[.!?]+/).map(r=>r.trim()).filter(r=>r.length>0).filter(r=>/\b(解決|修正|対応|fix|resolve|solve|solution|答え|回答|方法)/i.test(r)).slice(0,3);return a.length>0?a.join(". ")+".":"\u89E3\u6C7A\u65B9\u6CD5\u306B\u3064\u3044\u3066\u306F\u8A73\u7D30\u306A\u8ABF\u67FB\u304C\u5FC5\u8981\u3067\u3059\u3002"}extractKeywords(e){let t=`${e.subject} ${e.body}`.toLowerCase(),i=[];return["api","database","server","client","network","security","auth","login","password","error","bug","performance","timeout","\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9","\u30B5\u30FC\u30D0\u30FC","\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF","\u30A8\u30E9\u30FC","\u30D0\u30B0","\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9"].forEach(r=>{t.includes(r)&&i.push(r)}),e.category&&i.push(e.category),i.push(...e.tags),[...new Set(i)]}generateKnowledgeTitle(e){let t=e.replace(/^(re:|fwd?:|fw:)\s*/i,"").replace(/\[.*?\]/g,"").trim();return/\b(解決|方法|how\s+to|solution|fix)/i.test(t)||(t=`\u89E3\u6C7A\u65B9\u6CD5: ${t}`),t}async generateKnowledgeFilePath(e){let t=new Date,i=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=`${this.settings.knowledgeFolder}/${i}/${a}`;await this.vault.exists(r)||await this.vault.createFolder(r);let s=this.sanitizeFilename(e.title),n=`${s}.md`,d=`${r}/${n}`,m=1;for(;await this.vault.exists(d);)n=`${s}-${m}.md`,d=`${r}/${n}`,m++;return d}generateKnowledgeContent(e,t){let i=e.toFrontmatter(),a=[];for(let[s,n]of Object.entries(i))n!=null&&(Array.isArray(n)?n.length>0&&(a.push(`${s}:`),n.forEach(d=>a.push(`  - "${d}"`))):typeof n=="string"?a.push(`${s}: "${n}"`):a.push(`${s}: ${n}`));return["---",a.join(`
`),"---","",`# ${e.title}`,"","## \u554F\u984C\u30FB\u8CEA\u554F","",e.problem,"","## \u89E3\u6C7A\u65B9\u6CD5\u30FB\u56DE\u7B54","",e.solution,"","## \u95A2\u9023\u60C5\u5831","",`**\u30AB\u30C6\u30B4\u30EA:** ${e.category||"\u305D\u306E\u4ED6"}`,`**\u30AD\u30FC\u30EF\u30FC\u30C9:** ${e.keywords.join(", ")}`,`**\u5143\u306E\u30E1\u30FC\u30EB:** [[${t.subject}]]`,`**\u4F5C\u6210\u65E5:** ${e.createdAt.toISOString().split("T")[0]}`,"","## \u30E1\u30E2","","<!-- \u8FFD\u52A0\u306E\u60C5\u5831\u3084\u95A2\u9023\u4E8B\u9805\u304C\u3042\u308C\u3070\u8A18\u9332\u3057\u3066\u304F\u3060\u3055\u3044 -->",""].join(`
`)}sanitizeFilename(e){return e.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g,"-").substring(0,50).toLowerCase()}updateSettings(e){this.settings=e}};var v=class{constructor(){this.translations=new Map;this.currentLanguage="en";this.fallbackLanguage="en";this.detectLanguage()}async initialize(){try{let e=await this.loadTranslationFile("en");this.translations.set("en",e);let t=await this.loadTranslationFile("ja");this.translations.set("ja",t)}catch(e){console.error("Failed to load translations:",e),this.translations.set("en",{}),this.translations.set("ja",{})}}async loadTranslationFile(e){try{if(e==="en"){let t=await Promise.resolve().then(()=>D(k()));return t.default||t}else if(e==="ja"){let t=await Promise.resolve().then(()=>D(T()));return t.default||t}throw new Error(`Unsupported language: ${e}`)}catch(t){return console.error(`Failed to load ${e} translations:`,t),{}}}detectLanguage(){(navigator.language||"en").startsWith("ja")?this.currentLanguage="ja":this.currentLanguage="en"}setLanguage(e){this.currentLanguage=e}getCurrentLanguage(){return this.currentLanguage}getAvailableLanguages(){return["en","ja"]}t(e,t){let i=this.getTranslation(e,this.currentLanguage)||this.getTranslation(e,this.fallbackLanguage)||e;return t?this.replaceParams(i,t):i}getTranslation(e,t){let i=this.translations.get(t);if(!i)return null;let a=e.split("."),r=i;for(let s of a)if(r&&typeof r=="object"&&s in r)r=r[s];else return null;return typeof r=="string"?r:null}replaceParams(e,t){return e.replace(/\{\{(\w+)\}\}/g,(i,a)=>t[a]!==void 0?String(t[a]):i)}getTranslationGroup(e){let t=this.translations.get(this.currentLanguage)||{},i=e.split("."),a=t;for(let r of i)if(a&&typeof a=="object"&&r in a)a=a[r];else{let n=this.translations.get(this.fallbackLanguage)||{};for(let d of i)if(n&&typeof n=="object"&&d in n)n=n[d];else return{};a=n;break}return a&&typeof a=="object"?a:{}}};var c=require("obsidian"),E=class{constructor(e,t){this.vault=e;this.fileManager=t}async create(e,t){try{await this.vault.create(e,t)}catch(i){throw new Error(`Failed to create file ${e}: ${i}`)}}async exists(e){try{return this.vault.getAbstractFileByPath(e)!==null}catch{return!1}}async createFolder(e){try{let t=e.split("/"),i="";for(let a of t)i=i?`${i}/${a}`:a,await this.exists(i)||await this.vault.createFolder(i)}catch(t){throw new Error(`Failed to create folder ${e}: ${t}`)}}async writeFile(e,t){try{let i=e.substring(0,e.lastIndexOf("/"));i&&!await this.exists(i)&&await this.createFolder(i);let a;if(t instanceof Buffer){let r=new ArrayBuffer(t.length),s=new Uint8Array(r);for(let n=0;n<t.length;++n)s[n]=t[n];a=r}else a=t;await this.vault.createBinary(e,a)}catch(i){throw new Error(`Failed to write file ${e}: ${i}`)}}async read(e){try{let t=this.vault.getAbstractFileByPath(e);if(!t||!(t instanceof c.TFile))throw new Error(`File not found: ${e}`);return await this.vault.read(t)}catch(t){throw new Error(`Failed to read file ${e}: ${t}`)}}async modify(e,t){try{let i=this.vault.getAbstractFileByPath(e);if(!i||!(i instanceof c.TFile))throw new Error(`File not found: ${e}`);await this.vault.modify(i,t)}catch(i){throw new Error(`Failed to modify file ${e}: ${i}`)}}async delete(e){try{let t=this.vault.getAbstractFileByPath(e);if(!t)throw new Error(`File not found: ${e}`);await this.vault.delete(t)}catch(t){throw new Error(`Failed to delete file ${e}: ${t}`)}}async list(e){try{let t=this.vault.getAbstractFileByPath(e);if(!t||!(t instanceof c.TFolder))return[];let i=[],a=r=>{for(let s of r.children)s instanceof c.TFile?i.push(s.path):s instanceof c.TFolder&&a(s)};return a(t),i}catch(t){throw new Error(`Failed to list folder ${e}: ${t}`)}}async getFiles(e){try{if(e){let t=this.vault.getAbstractFileByPath(e);if(!t||!(t instanceof c.TFolder))return[];let i=[],a=r=>{for(let s of r.children)s instanceof c.TFile?i.push(s):s instanceof c.TFolder&&a(s)};return a(t),i}else return this.vault.getMarkdownFiles()}catch(t){throw new Error(`Failed to get files from ${e}: ${t}`)}}async rename(e,t){try{let i=this.vault.getAbstractFileByPath(e);if(!i)throw new Error(`File not found: ${e}`);await this.fileManager.renameFile(i,t)}catch(i){throw new Error(`Failed to rename ${e} to ${t}: ${i}`)}}async copy(e,t){try{let i=this.vault.getAbstractFileByPath(e);if(!i||!(i instanceof c.TFile))throw new Error(`Source file not found: ${e}`);let a=await this.vault.read(i);await this.create(t,a)}catch(i){throw new Error(`Failed to copy ${e} to ${t}: ${i}`)}}};var g=require("obsidian");var S=class extends g.Modal{constructor(e,t,i,a,r){super(e),this.emailCaptureService=t,this.settings=i,this.i18nService=a,this.onSuccess=r}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.i18nService.t("modal.capture_email.title")}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.sender_email")).setDesc("Email address of the person who sent the inquiry").addText(i=>{this.senderInput=i,i.setPlaceholder(this.i18nService.t("modal.capture_email.placeholder.sender_email")).onChange(a=>{this.validateEmail(a)})}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.sender_name")).setDesc("Display name of the sender (optional)").addText(i=>{this.senderNameInput=i,i.setPlaceholder(this.i18nService.t("modal.capture_email.placeholder.sender_name"))}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.subject")).setDesc("Email subject line").addText(i=>{this.subjectInput=i,i.setPlaceholder(this.i18nService.t("modal.capture_email.placeholder.subject"))}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.category")).setDesc("Categorize this inquiry").addDropdown(i=>{this.categoryDropdown=i;let a=this.i18nService.getTranslationGroup("categories");i.addOption("","Select category..."),i.addOption("specification",a.specification).addOption("issue",a.issue).addOption("migration_vup",a.migration_vup).addOption("other",a.other),this.settings.customCategories&&this.settings.customCategories.length>0&&(i.addOption("---","--- Custom Categories ---"),this.settings.customCategories.forEach(r=>{i.addOption(r,r)})),i.setValue(this.settings.defaultCategory)}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.priority")).setDesc("Priority level of this inquiry").addDropdown(i=>{this.priorityDropdown=i;let a=this.i18nService.getTranslationGroup("priorities");i.addOption("low",a.low).addOption("medium",a.medium).addOption("high",a.high).addOption("urgent",a.urgent).setValue(this.settings.defaultPriority)}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.tags")).setDesc("Comma-separated tags for this email").addText(i=>{this.tagsInput=i,i.setPlaceholder(this.i18nService.t("modal.capture_email.placeholder.tags"))}),new g.Setting(e).setName(this.i18nService.t("modal.capture_email.email_content")).setDesc("The main content of the email").addTextArea(i=>{this.bodyInput=i,i.setPlaceholder(this.i18nService.t("modal.capture_email.placeholder.email_content")).inputEl.style.height="200px"});let t=e.createDiv("modal-button-container");t.style.display="flex",t.style.justifyContent="space-between",t.style.marginTop="20px",t.createEl("button",{text:this.i18nService.t("modal.capture_email.cancel_button")},i=>{i.onclick=()=>{this.close()}}),t.createEl("button",{text:this.i18nService.t("modal.capture_email.capture_button"),cls:"mod-cta"},i=>{i.onclick=async()=>{await this.captureEmail()}}),setTimeout(()=>{this.senderInput.inputEl.focus()},100)}onClose(){let{contentEl:e}=this;e.empty()}validateEmail(e){let i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),a=this.senderInput.inputEl;return e&&!i?(a.style.borderColor="red",a.style.boxShadow="0 0 5px rgba(255, 0, 0, 0.3)"):(a.style.borderColor="",a.style.boxShadow=""),i}validateForm(){let e=[],t=this.senderInput.getValue().trim(),i=this.subjectInput.getValue().trim(),a=this.bodyInput.getValue().trim();return t?this.validateEmail(t)||e.push(this.i18nService.t("modal.capture_email.validation.sender_email_invalid")):e.push(this.i18nService.t("modal.capture_email.validation.sender_email_required")),i||e.push(this.i18nService.t("modal.capture_email.validation.subject_required")),a||e.push(this.i18nService.t("modal.capture_email.validation.content_required")),{isValid:e.length===0,errors:e}}async captureEmail(){try{let e=this.validateForm();if(!e.isValid){let s=e.errors.join(`
`);this.showError(`Please fix the following errors:

${s}`);return}let t={sender:this.senderInput.getValue().trim(),senderName:this.senderNameInput.getValue().trim()||void 0,subject:this.subjectInput.getValue().trim(),body:this.bodyInput.getValue().trim(),receivedDate:new Date().toISOString(),category:this.categoryDropdown.getValue()||void 0,priority:this.priorityDropdown.getValue()||"medium",tags:this.parseTags(this.tagsInput.getValue())},i=this.contentEl.querySelector(".mod-cta"),a=i.textContent;i.textContent="Capturing...",i.disabled=!0;let r=await this.emailCaptureService.captureEmail(t);this.onSuccess(r),this.close()}catch(e){this.showError(`Failed to capture email: ${e instanceof Error?e.message:String(e)}`);let t=this.contentEl.querySelector(".mod-cta");t.textContent="Capture Email",t.disabled=!1}}parseTags(e){return e.split(",").map(t=>t.trim()).filter(t=>t.length>0)}showError(e){let t=this.contentEl.querySelector(".modal-error");t&&t.remove();let i=this.contentEl.createDiv("modal-error");i.style.color="red",i.style.backgroundColor="rgba(255, 0, 0, 0.1)",i.style.padding="10px",i.style.marginTop="10px",i.style.borderRadius="4px",i.style.border="1px solid red",i.textContent=e,setTimeout(()=>{i.parentNode&&i.remove()},5e3)}};var l=require("obsidian");var _=class extends l.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty();let t=this.plugin.getI18nService();e.createEl("h2",{text:t.t("settings.title")}),e.createEl("h3",{text:t.t("settings.folders.title")}),new l.Setting(e).setName(t.t("settings.folders.emails_folder")).setDesc(t.t("settings.folders.emails_folder_desc")).addText(r=>r.setPlaceholder("Emails").setValue(this.plugin.settings.emailsFolder).onChange(async s=>{this.plugin.settings.emailsFolder=s||"Emails",await this.plugin.saveSettings()})),new l.Setting(e).setName(t.t("settings.folders.summaries_folder")).setDesc(t.t("settings.folders.summaries_folder_desc")).addText(r=>r.setPlaceholder("Summaries").setValue(this.plugin.settings.summariesFolder).onChange(async s=>{this.plugin.settings.summariesFolder=s||"Summaries",await this.plugin.saveSettings()})),new l.Setting(e).setName(t.t("settings.folders.knowledge_folder")).setDesc(t.t("settings.folders.knowledge_folder_desc")).addText(r=>r.setPlaceholder("Knowledge").setValue(this.plugin.settings.knowledgeFolder).onChange(async s=>{this.plugin.settings.knowledgeFolder=s||"Knowledge",await this.plugin.saveSettings()})),e.createEl("h3",{text:t.t("settings.defaults.title")}),new l.Setting(e).setName(t.t("settings.defaults.category")).setDesc(t.t("settings.defaults.category_desc")).addDropdown(r=>{let s=t.getTranslationGroup("categories");r.addOption("specification",s.specification).addOption("issue",s.issue).addOption("migration_vup",s.migration_vup).addOption("other",s.other),this.plugin.settings.customCategories&&this.plugin.settings.customCategories.length>0&&this.plugin.settings.customCategories.forEach(n=>{r.addOption(n,n)}),r.setValue(this.plugin.settings.defaultCategory).onChange(async n=>{this.plugin.settings.defaultCategory=n,await this.plugin.saveSettings()})}),new l.Setting(e).setName(t.t("settings.defaults.priority")).setDesc(t.t("settings.defaults.priority_desc")).addDropdown(r=>{let s=t.getTranslationGroup("priorities");r.addOption("low",s.low).addOption("medium",s.medium).addOption("high",s.high).addOption("urgent",s.urgent).setValue(this.plugin.settings.defaultPriority).onChange(async n=>{this.plugin.settings.defaultPriority=n,await this.plugin.saveSettings()})}),e.createEl("h3",{text:t.t("settings.automation.title")}),new l.Setting(e).setName(t.t("settings.automation.auto_summary")).setDesc(t.t("settings.automation.auto_summary_desc")).addToggle(r=>r.setValue(this.plugin.settings.autoGenerateSummary).onChange(async s=>{this.plugin.settings.autoGenerateSummary=s,await this.plugin.saveSettings()})),new l.Setting(e).setName(t.t("settings.automation.auto_knowledge")).setDesc(t.t("settings.automation.auto_knowledge_desc")).addToggle(r=>r.setValue(this.plugin.settings.autoExtractKnowledge).onChange(async s=>{this.plugin.settings.autoExtractKnowledge=s,await this.plugin.saveSettings()})),new l.Setting(e).setName(t.t("settings.automation.enable_notifications")).setDesc(t.t("settings.automation.enable_notifications_desc")).addToggle(r=>r.setValue(this.plugin.settings.enableNotifications).onChange(async s=>{this.plugin.settings.enableNotifications=s,await this.plugin.saveSettings()})),e.createEl("h3",{text:t.t("settings.categories.title")});let i=e.createDiv("custom-categories-container");i.style.marginBottom="15px";let a=i.createEl("p",{text:t.t("settings.categories.manage_desc"),cls:"setting-item-description"});a.style.marginBottom="8px",a.style.color="var(--text-muted)",a.style.fontSize="13px",this.displayCustomCategories(i,t),new l.Setting(e).setName(t.t("settings.categories.add_category")).setDesc(t.t("settings.categories.add_category_desc")).addText(r=>{r.setPlaceholder(t.t("settings.categories.category_placeholder"));let s=e.createEl("button",{text:t.t("settings.categories.add_button"),cls:"mod-cta"});s.style.marginLeft="10px",s.onclick=async()=>{let n=r.getValue().trim();n&&!this.plugin.settings.customCategories.includes(n)&&(this.plugin.settings.customCategories.push(n),await this.plugin.saveSettings(),r.setValue(""),this.displayCustomCategories(i,t))},r.inputEl.parentElement?.appendChild(s)}),e.createEl("h3",{text:t.t("settings.advanced.title")}),new l.Setting(e).setName(t.t("settings.advanced.language")).setDesc(t.t("settings.advanced.language_desc")).addDropdown(r=>{let s=t.getTranslationGroup("languages");r.addOption("en",s.en).addOption("ja",s.ja).setValue(this.plugin.settings.language).onChange(async n=>{this.plugin.settings.language=n,await this.plugin.saveSettings(),this.display()})}),new l.Setting(e).setName(t.t("settings.advanced.max_attachment_size")).setDesc(t.t("settings.advanced.max_attachment_size_desc")).addText(r=>r.setPlaceholder("10").setValue(String(this.plugin.settings.maxAttachmentSize/(1024*1024))).onChange(async s=>{let n=parseFloat(s)||10;this.plugin.settings.maxAttachmentSize=n*1024*1024,await this.plugin.saveSettings()})),new l.Setting(e).setName("Reset Settings").setDesc("Reset all settings to default values").addButton(r=>r.setButtonText("Reset to Defaults").setWarning().onClick(async()=>{confirm("Are you sure you want to reset all settings to default values? This cannot be undone.")&&(this.plugin.settings={emailsFolder:"Emails",summariesFolder:"Summaries",knowledgeFolder:"Knowledge",defaultCategory:"specification",defaultPriority:"medium",autoGenerateSummary:!0,autoExtractKnowledge:!1,enableNotifications:!0,maxAttachmentSize:10*1024*1024,language:"en",customCategories:[]},await this.plugin.saveSettings(),this.display())})),e.createEl("h3",{text:"About"}),e.createEl("p",{text:"Email Inquiry Management Plugin v1.0.0 - Capture, organize, and build knowledge from email inquiries."})}displayCustomCategories(e,t){if(e.empty(),this.plugin.settings.customCategories.length===0){e.createEl("p",{text:t.t("settings.categories.no_custom_categories"),cls:"setting-item-description"});return}let i=e.createEl("div",{cls:"custom-categories-list"});i.style.display="flex",i.style.flexWrap="wrap",i.style.gap="8px",i.style.marginTop="8px",this.plugin.settings.customCategories.forEach((a,r)=>{let s=i.createEl("span",{text:a,cls:"category-tag"});s.style.backgroundColor="var(--interactive-accent)",s.style.color="var(--text-on-accent)",s.style.padding="4px 8px",s.style.borderRadius="12px",s.style.fontSize="12px",s.style.display="inline-flex",s.style.alignItems="center",s.style.gap="4px";let n=s.createEl("span",{text:"\xD7",cls:"category-remove"});n.style.cursor="pointer",n.style.fontWeight="bold",n.style.marginLeft="4px",n.style.opacity="0.8",n.style.fontSize="14px",n.style.lineHeight="1",n.style.width="16px",n.style.height="16px",n.style.display="inline-flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.borderRadius="50%",n.style.transition="all 0.2s ease",n.title=t.t("settings.categories.delete_tooltip"),n.addEventListener("mouseenter",()=>{n.style.opacity="1",n.style.backgroundColor="rgba(255, 255, 255, 0.2)",n.style.transform="scale(1.1)"}),n.addEventListener("mouseleave",()=>{n.style.opacity="0.8",n.style.backgroundColor="transparent",n.style.transform="scale(1)"}),n.onclick=async()=>{confirm(t.t("settings.categories.delete_confirm",{category:a}))&&(this.plugin.settings.customCategories.splice(r,1),await this.plugin.saveSettings(),this.displayCustomCategories(e,t))}})}};var B={emailsFolder:"Emails",summariesFolder:"Summaries",knowledgeFolder:"Knowledge",defaultCategory:"specification",defaultPriority:"medium",autoGenerateSummary:!0,autoExtractKnowledge:!1,enableNotifications:!0,maxAttachmentSize:10*1024*1024,language:"en",customCategories:[]},p=class extends u.Plugin{async onload(){console.log("Loading Email Inquiry Plugin"),await this.loadSettings(),this.i18nService=new v,await this.i18nService.initialize(),this.i18nService.setLanguage(this.settings.language),this.vaultAdapter=new E(this.app.vault,this.app.fileManager),this.knowledgeExtractionService=new w(this.vaultAdapter,{knowledgeFolder:this.settings.knowledgeFolder,autoExtractKnowledge:this.settings.autoExtractKnowledge,enableNotifications:this.settings.enableNotifications}),this.emailCaptureService=new h(this.vaultAdapter,this.settings.emailsFolder,void 0,this.knowledgeExtractionService),this.addSettingTab(new _(this.app,this)),this.registerCommands(),this.addRibbonIcon("mail",this.i18nService.t("ribbon.capture_email"),()=>{this.openEmailCaptureModal()}),console.log("[EmailInquiry] Plugin loaded successfully with settings:",{emailsFolder:this.settings.emailsFolder,summariesFolder:this.settings.summariesFolder,knowledgeFolder:this.settings.knowledgeFolder,autoExtractKnowledge:this.settings.autoExtractKnowledge,language:this.settings.language})}onunload(){console.log("Unloading Email Inquiry Plugin")}async loadSettings(){this.settings=Object.assign({},B,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.i18nService&&this.i18nService.setLanguage(this.settings.language),this.vaultAdapter&&(this.knowledgeExtractionService.updateSettings({knowledgeFolder:this.settings.knowledgeFolder,autoExtractKnowledge:this.settings.autoExtractKnowledge,enableNotifications:this.settings.enableNotifications}),this.emailCaptureService=new h(this.vaultAdapter,this.settings.emailsFolder,void 0,this.knowledgeExtractionService)),console.log("[EmailInquiry] Settings updated:",{emailsFolder:this.settings.emailsFolder,knowledgeFolder:this.settings.knowledgeFolder,autoExtractKnowledge:this.settings.autoExtractKnowledge})}registerCommands(){this.addCommand({id:"capture-email",name:this.i18nService.t("commands.capture_email"),callback:()=>{this.openEmailCaptureModal()}}),this.addCommand({id:"generate-daily-summary",name:this.i18nService.t("commands.generate_daily_summary"),callback:()=>{this.generateDailySummary()}}),this.addCommand({id:"search-knowledge-base",name:this.i18nService.t("commands.search_knowledge_base"),callback:()=>{this.openKnowledgeSearch()}}),this.addCommand({id:"bulk-import-emails",name:this.i18nService.t("commands.bulk_import_emails"),callback:()=>{this.openBulkImportModal()}})}openEmailCaptureModal(){new S(this.app,this.emailCaptureService,this.settings,this.i18nService,e=>{this.settings.enableNotifications&&new u.Notice(this.i18nService.t("notices.email_captured",{path:e.path}))}).open()}async generateDailySummary(){try{let e=new Date().toISOString().split("T")[0];new u.Notice(this.i18nService.t("notices.generating_summary",{date:e})),new u.Notice(this.i18nService.t("notices.summary_generated"))}catch(e){new u.Notice(this.i18nService.t("notices.error_generating_summary",{error:String(e)}))}}openKnowledgeSearch(){new u.Notice(this.i18nService.t("notices.knowledge_search_coming_soon"))}openBulkImportModal(){new u.Notice(this.i18nService.t("notices.bulk_import_coming_soon"))}getEmailsFolder(){return this.settings.emailsFolder}getSummariesFolder(){return this.settings.summariesFolder}getKnowledgeFolder(){return this.settings.knowledgeFolder}getI18nService(){return this.i18nService}};
