# 📖 使用方法

Email Inquiry Management Plugin の具体的な使い方を詳しく説明します。

## 🎯 基本操作

### メールのキャプチャ

#### 方法1: コマンドパレット
1. **`Ctrl+P`** (Windows/Linux) または **`Cmd+P`** (Mac) でコマンドパレットを開く
2. **「メールをキャプチャ」** と入力（日本語設定の場合）
3. **Enter** を押してモーダルを開く

#### 方法2: リボンアイコン
1. 左サイドバーの **📧 アイコン** をクリック
2. メール入力モーダルが開く

### メール情報の入力

#### 必須フィールド
- **送信者メール**: `customer@example.com` 形式で入力
- **件名**: メールの件名
- **メール内容**: メール本文

#### オプションフィールド
- **送信者名**: 表示名（例: 田中太郎）
- **カテゴリ**: 仕様、障害、移行/VUP、その他、カスタムカテゴリ
- **優先度**: 低、中、高、緊急
- **タグ**: カンマ区切り（例: ログイン問題, 緊急, サポート）

#### 入力例
```
送信者メール: support@company.com
送信者名: 田中 太郎
件名: ダッシュボードへのアクセス権限について
カテゴリ: 仕様
優先度: 中
タグ: アクセス権限, ダッシュボード, 設定
メール内容: 
お疲れ様です。
新しいダッシュボードへのアクセス権限について...
```

## 🏷️ カテゴリ管理

### デフォルトカテゴリ

| カテゴリ | 用途 | 例 |
|---------|------|-----|
| **仕様** | 要件確認、設計相談 | API仕様の確認、機能要件の相談 |
| **障害** | バグ、システム障害 | ログインできない、エラーが発生 |
| **移行/VUP** | システム移行、アップグレード | サーバー移行、バージョンアップ |
| **その他** | 一般的な問い合わせ | 契約について、利用方法の質問 |

### カスタムカテゴリの管理

#### カテゴリの追加
1. **設定** → **Email Inquiry Management**
2. **「カスタムカテゴリ」** セクションに移動
3. **カテゴリ名を入力** (例: バグレポート、機能要求)
4. **「追加」ボタン** をクリック

#### カテゴリの削除
1. **設定画面** で削除したいカテゴリを確認
2. **カテゴリタグの ×ボタン** をクリック
3. **確認ダイアログ** で「OK」をクリック

#### おすすめカスタムカテゴリ

**ビジネス用途:**
```
- バグレポート
- 機能要求
- アカウント問題
- 支払い相談
- 商品問い合わせ
- 返品・交換
```

**開発チーム用途:**
```
- コードレビュー
- デプロイ相談
- パフォーマンス問題
- セキュリティ相談
- インフラ構築
```

## 🔄 メールの管理

### ステータス管理

メールには以下のステータスを設定できます：

- **pending** (保留中): 新着メール、対応待ち
- **in_progress** (対応中): 現在作業中
- **resolved** (解決済み): 問題解決完了
- **archived** (アーカイブ): 長期保存

#### ステータスの変更
1. **対象のメールファイルを開く**
2. **フロントマターの `status` を編集**
   ```yaml
   ---
   status: "resolved"  # pending → resolved に変更
   ---
   ```

### 優先度による管理

#### 優先度レベル
- **緊急** (urgent): 即座に対応が必要
- **高** (high): 1日以内に対応
- **中** (medium): 1週間以内に対応  
- **低** (low): 時間があるときに対応

#### 優先度別の検索
```dataview
TABLE sender AS "送信者", subject AS "件名", priority AS "優先度"
FROM "Emails"
WHERE priority = "urgent"
SORT receivedDate DESC
```

## 📁 ファイル組織

### 自動フォルダ構造

メールは自動的に以下の構造で保存されます：

```
Emails/
└── 2024/
    └── 09/
        ├── 06-09-30-ログイン問題について.md
        ├── 06-10-15-API仕様の確認.md
        └── 06-11-00-サーバー移行計画.md

Summaries/
├── 2024-09-06-daily-summary.md
└── 2024-09-07-daily-summary.md

Knowledge/
├── ログイン-トラブルシューティング.md
└── API-認証方法.md
```

### ファイル命名規則

**メールファイル:**
```
{日}-{時}-{分}-{件名の省略形}.md

例: 06-14-30-ログイン問題について.md
```

**サマリーファイル:**
```
{年}-{月}-{日}-daily-summary.md

例: 2024-09-06-daily-summary.md
```

## 🔍 検索と分析

### Dataview による分析

#### カテゴリ別集計
```dataview
TABLE category AS "カテゴリ", count(rows) AS "件数"
FROM "Emails"
GROUP BY category
SORT count(rows) DESC
```

#### 未解決メール一覧
```dataview
TABLE sender AS "送信者", subject AS "件名", priority AS "優先度", receivedDate AS "受信日"
FROM "Emails"
WHERE status = "pending"
SORT priority DESC, receivedDate ASC
```

#### 月別メール数推移
```dataview
TABLE dateformat(receivedDate, "yyyy-MM") AS "月", count(rows) AS "件数"
FROM "Emails"
WHERE receivedDate >= date("2024-01-01")
GROUP BY dateformat(receivedDate, "yyyy-MM")
SORT dateformat(receivedDate, "yyyy-MM") DESC
```

### タグによる横断検索

#### よく使われるタグの例
- **技術系**: `API`, `認証`, `データベース`, `パフォーマンス`
- **業務系**: `契約`, `請求`, `アカウント`, `権限`
- **緊急度**: `緊急`, `重要`, `至急`, `優先`

#### タグ検索クエリ
```dataview
LIST
FROM #緊急 AND #サポート
SORT receivedDate DESC
```

## 📊 日次サマリー

### 自動生成

#### 設定での有効化
1. **設定** → **Email Inquiry Management**
2. **「自動化」** セクション
3. **「日次サマリーの自動生成」** を有効化

#### 手動生成
1. **コマンドパレット** (`Ctrl+P`)
2. **「日次サマリーを生成」** と入力
3. **Enter** で実行

### サマリー内容

生成されるサマリーには以下が含まれます：

- **総メール数** と ステータス別内訳
- **カテゴリ別** 分布
- **優先度別** 分布  
- **トップ送信者** リスト
- **よく使われるタグ**
- **時間別** メール受信数

#### サマリー例
```markdown
# 日次メールサマリー - 2024-09-06

## 📊 概要
- **総メール数**: 24件
- **新規**: 8件
- **対応中**: 12件  
- **解決済み**: 4件

## 📋 カテゴリ別
- 仕様: 8件 (33%)
- 障害: 6件 (25%)
- 移行/VUP: 4件 (17%)
- その他: 6件 (25%)

## ⚡ 優先度別
- 緊急: 2件
- 高: 6件
- 中: 12件
- 低: 4件
```

## 🧠 ナレッジベース構築

### 解決済みメールからの抽出

#### 手動抽出
1. **メールを解決済みにマーク**
   ```yaml
   ---
   status: "resolved"
   ---
   ```

2. **解決内容を「メモ」セクションに記録**
   ```markdown
   ## メモ
   
   ### 原因
   ログイン認証の設定ミス
   
   ### 解決方法
   1. 管理画面でユーザー権限を確認
   2. 認証設定を「有効」に変更
   3. キャッシュをクリア
   
   ### 今後の予防策
   定期的な権限監査の実施
   ```

3. **ナレッジ抽出コマンドを実行**
   - コマンドパレット → 「ナレッジを抽出」

#### 自動抽出（将来機能）
- 解決済みメールから自動的にパターンを検出
- よくある問題と解決方法をデータベース化
- 類似問題の自動提案

## ⚙️ 設定カスタマイズ

### フォルダ設定

#### デフォルト構造の変更
```yaml
メールフォルダ: "CustomerSupport/Emails"
サマリーフォルダ: "Reports/Daily"  
ナレッジフォルダ: "KB/Solutions"
```

### 言語設定

#### 日本語 ⇔ English 切り替え
1. **設定** → **Email Inquiry Management**
2. **詳細設定** → **言語**
3. **「日本語」** または **「English」** を選択
4. **即座にUIが切り替わる**

### 通知設定

#### 通知の種類
- メールキャプチャ完了
- サマリー生成完了
- エラー発生時
- ナレッジ抽出完了

#### カスタマイズ
```yaml
enableNotifications: true
notificationTypes:
  - capture_success
  - summary_generated  
  - error_occurred
```

## 🚀 高度な使用法

### テンプレート活用

#### メールテンプレート作成
```markdown
<!-- テンプレート: サポートメール -->
---
category: "障害"
priority: "medium"
tags: ["サポート"]
---

# {{subject}}

**送信者:** {{sender}}
**受信日:** {{date}}

## 問題の詳細


## 対応履歴


## 解決メモ

```

### 自動化ワークフロー

#### Templater プラグインとの連携
1. **Templater** プラグインをインストール
2. **自動タグ付け**スクリプトを作成
3. **キーワードベース分類**を設定

#### Dataview との連携
1. **動的ダッシュボード**の作成
2. **リアルタイム統計**の表示
3. **トレンド分析**の自動化

---

**この使用方法ガイドで、プラグインを最大限活用してください！**

次は [カスタマイズ方法](customization.md) をご覧ください。